@page "/"
@using MagFlow.BLL.Services.Interfaces
@using MagFlow.Shared.DTOs.Core
@using MagFlow.Web.Pages.Modules

@inject NavigationManager NavigationManager
@inject IUserService UserService

<div class="d-flex flex-column w-100 flex-grow-1 pt-2" style="min-height: 0">
    <ModuleTabs/>
</div>

@code {
    UserSessionDTO? LastSession = null;

    protected override async Task OnInitializedAsync()
    {
        LastSession = (await UserService.GetLastSessions())?.FirstOrDefault();

        if(LastSession == null || LastSession.ExpiresAt <= DateTime.UtcNow)
        {
            NavigationManager.NavigateTo("/lobby");
            return;
        }
    }
}
