@page "/lobby"
@using MagFlow.BLL.Services.Interfaces
@using MagFlow.Shared.DTOs.Core
@using MagFlow.Web.Pages.Modules
@using MagFlow.Web.Pages.Modules.Users
@using MagFlow.Web.Pages.Modules.Wares
@using MudBlazor

@inject IUserService UserService

<div class="d-flex flex-column w-100 flex-grow-1 px-4 pt-2" style="min-height: 0">
    <div class="text-start d-flex align-items-start flex-column flex-shrink-0" style="gap: 8px;">
        <MudText Typo="Typo.h4" Style="font-weight: 700">@Localizer[Langs.StartPanel]</MudText>
        <MudText Typo="Typo.subtitle1" Style="color: var(--mud-palette-text-secondary)">@Localizer[Langs.StartPanelWelcomeText]</MudText>
    </div>
    <div class="d-flex w-100 mt-6" style="gap: 16px; flex: 1 1 0; min-height: 0">
        <div class="d-flex flex-column justify-content-start align-items-center" style="padding: 16px; background: var(--white, #FFF); border-radius: 8px; min-width: 300px; flex: 0 0 auto;">
            <div class="d-flex align-items-center align-self-stretch">
                <div class="d-flex justify-content-center align-items-center" style="@($"width: 32px; height: 32px; aspect-ratio: 1/1; border-radius: 6px; background: {Colors.Blue.Lighten5}")">
                    <MudIcon Icon="@Icons.Material.Filled.Restore" Color="Color.Primary" Size="Size.Small"/>    
                </div>
                <div class="d-flex align-items-center justify-content-start">
                    <MudText Typo="Typo.h5" Style="font-weight: 700; padding: 8px">@Localizer[Langs.LastSessions]</MudText>
                </div>
            </div>
            <div class="d-flex flex-column align-items-start align-self-stretch" style="gap: 16px; flex: 1 1 auto; min-height: 0; overflow: auto; box-sizing: border-box;">
                @foreach(var userSession in userSessions)
                {
                    <div class="d-flex flex-column align-self-stretch justify-content-between" style="gap: 16px; border-radius: 8px; padding: 16px; box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.08)">
                        <div class="d-flex flex-column align-items-start align-self-stretch" style="gap: 8px">
                            <div class="d-flex justify-content-between align-items-center align-self-stretch" style="padding-bottom: 8px">
                                <div class="d-flex align-items-center" style="gap: 8px">
                                    <MudIcon Icon="@Icons.Material.Filled.AccessTime" Style="color: var(--bs-gray-600)"/>
                                    <MudText Typo="Typo.body2" Style="color: var(--bs-gray-600)">2 godz. temu</MudText>
                                </div>
                                <div class="d-flex justify-content-center align-items-center" style="@($"padding: 4px; border-radius: 8px; background: {Colors.Blue.Lighten4}")">
                                    <MudText Typo="Typo.body2" Color="Color.Primary">@string.Concat(userSession.Modules.Count, " moduły")</MudText>
                                </div>
                            </div>
                            <div class="d-flex align-items-start align-self-stretch" style="gap: 12px;">
                                @foreach(var module in userSession.Modules)
                                {
                                    <MudIcon Icon="@module.ModuleComponent.Icon" Size="Size.Small" Class="my-1"/>
                                }
                            </div>
                        </div>
                        <MudButton StartIcon="@Icons.Material.Filled.Restore" Style="background-color: var(--white, #FFF)" IconColor="Color.Primary" Color="Color.Primary">@Localizer[Langs.Restore]</MudButton>
                    </div>
                }
            </div>
        </div>
        <div class="flex-grow-1 d-flex flex-column align-items-start" style="min-height: 0; background: var(--white, #FFF); border-radius: 8px; padding: 16px;">
            <div class="d-flex flex-column align-items-start w-100" style="gap: 16px; flex: 1 0 0;">
                <div class="d-flex align-items-center align-self-stretch justify-content-between">
                    <div class="d-flex align-items-center align-self-stretch">
                        <div class="d-flex justify-content-center align-items-center" style="@($"width: 32px; height: 32px; aspect-ratio: 1/1; border-radius: 6px; background: {Colors.Blue.Lighten5}")">
                            <MudIcon Icon="@Icons.Material.Filled.GridView" Color="Color.Primary" Size="Size.Small" />
                        </div>
                        <div class="d-flex align-items-center justify-content-start">
                            <MudText Typo="Typo.h5" Style="font-weight: 700; padding: 8px">@Localizer[Langs.Modules]</MudText>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end align-items-center">
                        <MudButton Style="background-color: var(--white, #FFF)" IconColor="Color.Primary" Color="Color.Primary">@Localizer[Langs.SelectAll]</MudButton>
                    </div>
                </div>
                <div class="d-flex flex-column align-items-start align-self-stretch" style="gap: 16px;">

                </div>
            </div>
        </div>
    </div>
</div>

@code {

    List<ModuleDTO> companyModules = new List<ModuleDTO>()
    {
        new ModuleDTO()
        {
            Name = "Procesy Produkcyjne",
            Description = "Zarządzanie i monitorowanie przebiegu produkcji w czasie rzeczywistym",
            
        },
        new ModuleDTO()
        {
            Name = "Zamówienia",
            Description = "Obsługa, śledzenie i realizacja zamówień produkcyjnych"
        },
        new ModuleDTO()
        {
            Name = "Magazyn",
            Description = "Kontrola stanów magazynowych oraz przepływu materiałów"
        },
        new ModuleDTO()
        {
            Name = "Użytkownicy",
            Description = "Zarządzanie kontami, rolami i uprawnieniami użytkowników"
        },
        new ModuleDTO()
        {
            Name = "Raporty",
            Description = "Analiza danych produkcyjnych i generowanie raportów"
        },
        new ModuleDTO()
        {
            Name = "Maszyny",
            Description = "Monitorowanie pracy maszyn i ich efektywności"
        },
    };

    List<UserSessionDTO> userSessions = new List<UserSessionDTO>()
    {
        new UserSessionDTO()
        {
            CreatedAt = new DateTime(2026,1,29,12,0,0),
            ExpiresAt = DateTime.MaxValue,
            Id = Guid.NewGuid(),
            Modules = new List<ModuleDTO>()
            {
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Wares",
                    Code = "Wares",
                    ModuleComponent = new Wares()
                }
            }
        },

        new UserSessionDTO()
        {
            CreatedAt = new DateTime(2026,1,29,12,0,0),
            ExpiresAt = DateTime.MaxValue,
            Id = Guid.NewGuid(),
            Modules = new List<ModuleDTO>()
            {
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Wares",
                    Code = "Wares",
                    ModuleComponent = new Wares()
                }
            }
        },

        new UserSessionDTO()
        {
            CreatedAt = new DateTime(2026,1,29,12,0,0),
            ExpiresAt = DateTime.MaxValue,
            Id = Guid.NewGuid(),
            Modules = new List<ModuleDTO>()
            {
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Wares",
                    Code = "Wares",
                    ModuleComponent = new Wares()
                }
            }
        },

        new UserSessionDTO()
        {
            CreatedAt = new DateTime(2026,1,29,12,0,0),
            ExpiresAt = DateTime.MaxValue,
            Id = Guid.NewGuid(),
            Modules = new List<ModuleDTO>()
            {
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Users",
                    Code = "Users",
                    ModuleComponent = new Users()
                },
                new ModuleDTO()
                {
                    Id = Guid.NewGuid(),
                    Name = "Wares",
                    Code = "Wares",
                    ModuleComponent = new Wares()
                }
            }
        }
    };
}
